(this.webpackJsonpreact_dialogflow_chat=this.webpackJsonpreact_dialogflow_chat||[]).push([[0],{108:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),o=n(10),r=n.n(o),c=(n(77),n(78),n(138)),i=n(142),l=n(143),u=n(147),d=n(140),h=n(23),f=n.n(h),p=n(15),b=n(33),x=n(13),j=n(11),g=n(146),m=n(148),O=n(64),w=n.n(O),y=n(6),v=Object(c.a)((function(e){return{botLine:{textAlign:"left"},userLine:{textAlign:"right"},botMessage:{display:"inline-block",backgroundColor:e.palette.primary.main,borderRadius:"20px 20px 20px 5px",margin:"10px 20px",textAlign:"left",maxWidth:"60%"},userMessage:Object(j.a)({display:"inline-block",backgroundColor:e.palette.primary.main,borderRadius:"20px 20px 5px 20px",margin:"10px 20px",textAlign:"right",maxWidth:"60%"},e.breakpoints.down("xs"),{fontSize:"0.5rem"}),messageText:Object(j.a)({padding:"10px 25px",color:"white",fontSize:"1.2rem"},e.breakpoints.down("xs"),{fontSize:"1rem",padding:"7px 17px"})}}));function k(e){var t=v();return Object(y.jsx)(u.a,{className:"bot"===e.sender?t.botLine:t.userLine,children:Object(y.jsx)(u.a,{className:"bot"===e.sender?t.botMessage:t.userMessage,children:Object(y.jsx)(d.a,{className:t.messageText,children:e.message})})})}var S=n(44),C=n(22);function I(e,t){t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(var n="",a=e;a>0;--a)n+=t[Math.floor(Math.random()*t.length)];return n}var M=n(49),T=n.n(M),N=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(S.a)(this,e),this.username=t,this.contexts=[];this.dialogflowEndpoint="http://localhost:5005/",n&&(this.sessionId=I(16))}return Object(C.a)(e,[{key:"getWelcomeMessage",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,n,a,s=this,o=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(o.length>0&&void 0!==o[0])||o[0],n="",a=this.dialogflowEndpoint+"welcome",e.abrupt("return",new Promise((function(e,o){T.a.post(a,{sessionId:s.sessionId,isNewUser:t}).then((function(t){console.log("response: "+JSON.stringify(t.data)),n=t.data.fulfillmentText,s.contexts=t.data.outputContexts,e(n)})).catch((function(e){console.log("There was an error fetching the message from dialogflow."),console.log(e),o(e)}))})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendMessageToBot",value:function(){var e=Object(b.a)(f.a.mark((function e(t){var n,a,s=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="",a=this.dialogflowEndpoint,e.abrupt("return",new Promise((function(e,o){T.a.post(a,{sessionId:s.sessionId,message:t,contexts:s.contexts}).then((function(t){console.log(t.data),n=t.data.fulfillmentText,s.contexts=t.data.outputContexts,e(n)})).catch((function(e){console.log("There was an error fetching the message from dialogflow."),console.log(e),o(e)}))})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sessionId",get:function(){return this._sessionId},set:function(e){this._sessionId=e}}]),e}(),W=Object(c.a)((function(e){var t;return{root:(t={borderRadius:"5px",padding:"20px",height:"600px"},Object(j.a)(t,e.breakpoints.down("xs"),{height:"600px"}),Object(j.a)(t,"backgroundColor",e.palette.primary.main),t),chatDisplay:{backgroundColor:"white",borderRadius:"5px",height:"100%"},chatMessageSection:{padding:"5px 20px"},chats:{overflow:"auto",bottom:0,height:"100%","&::-webkit-scrollbar":{display:"none !important"},scrollbarWidth:"none"},textFieldInputRoot:Object(j.a)({height:"1.5rem",fontSize:"1.2rem"},e.breakpoints.down("xs"),{height:"1.2rem",fontSize:"1rem"})}}));function R(){var e=W(),t=Object(a.useState)(new N),n=Object(x.a)(t,1)[0],s=Object(a.useState)(""),o=Object(x.a)(s,2),r=o[0],c=o[1],i=Object(a.useState)(""),l=Object(x.a)(i,2),d=l[0],h=l[1],j=Object(a.useState)([]),O=Object(x.a)(j,2),v=O[0],S=O[1],C=Object(a.useState)([]),I=Object(x.a)(C,2),M=I[0],T=I[1],R=Object(a.useState)(null),z=Object(x.a)(R,2),B=z[0],E=z[1],F=Object(a.useState)(""),L=Object(x.a)(F,2),P=(L[0],L[1]);function A(){var e={message:d,index:v.length};S((function(t){return[].concat(Object(p.a)(t),[e])})),h("")}return Object(a.useEffect)((function(){n.getWelcomeMessage().then((function(e){c(e)})).catch((function(e){P("Our bot had a problem getting the welcome message. Sorry!"),c("Uh oh: Our bot had a problem getting the welcome message. Sorry!")}))}),[]),Object(a.useEffect)((function(){function e(){B.scrollIntoView(!1,{block:"end"})}function t(){return(t=Object(b.a)(f.a.mark((function e(t,s){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.sendMessageToBot(t).then((function(e){a(e,s)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function a(t,n){var a={message:t,inReplyToUserMessageIndex:n,index:0};T((function(e){return[].concat(Object(p.a)(e),[a])})),e()}B&&e(),v.length&&function(e,n){t.apply(this,arguments)}(v[v.length-1].message,v.length-1)}),[v]),Object(y.jsx)(u.a,{className:e.root,border:2,children:Object(y.jsxs)(u.a,{display:"flex",flexDirection:"column",className:e.chatDisplay,border:2,children:[Object(y.jsx)(u.a,{className:e.chats,children:Object(y.jsxs)(u.a,{flexGrow:"1",display:"flex",flexDirection:"column",justifyContent:"flex-end",children:[r?Object(y.jsx)(k,{sender:"bot",message:r}):null,v.map((function(e){return Object(y.jsxs)("span",{children:[Object(y.jsx)(k,{sender:"user",message:e.message}),M.filter((function(t){return t.inReplyToUserMessageIndex===e.index})).map((function(e){return Object(y.jsx)(k,{sender:"bot",message:e.message},e.index)}))]},e.index)})),Object(y.jsx)("div",{style:{float:"left",clear:"both"},ref:function(e){E(e)}})]})}),Object(y.jsxs)(u.a,{display:"flex",flexWrap:"nowrap",borderTop:1,className:e.chatMessageSection,children:[Object(y.jsx)(u.a,{flexGrow:"1",children:Object(y.jsx)(g.a,{fullWidth:!0,placeholder:"Send a message...",value:d,onChange:function(e,t){h(e.target.value)},onKeyPress:function(e,t){13===e.charCode&&A()},inputProps:{className:e.textFieldInputRoot}})}),Object(y.jsx)(m.a,{onClick:A,icon:"true",children:Object(y.jsx)(w.a,{color:"primary"})})]})]})})}var z=Object(c.a)({root:{},chatContainer:{marginTop:"50px"}});function B(){var e=z();return Object(y.jsx)("div",{className:e.root,children:Object(y.jsx)(i.a,{maxWidth:"xl",children:Object(y.jsx)(l.a,{container:!0,style:{flexWrap:"wrap-reverse"},justify:"center",children:Object(y.jsxs)(l.a,{item:!0,md:8,xs:12,children:[Object(y.jsx)(u.a,{pt:4,children:Object(y.jsx)(d.a,{variant:"h3",color:"secondary",children:"Birthday Bot!"})}),Object(y.jsx)(i.a,{className:e.chatContainer,children:Object(y.jsx)(R,{})})]})})})})}var E=n(144),F=n(65),L=n(145),P=Object(F.a)({palette:{background:{default:"#333333"},primary:{main:"#007bff"},secondary:{main:"#ffffff",contrastText:"#ffcc00"}},typography:{fontSize:12,h3:{}}});var A=function(){return Object(y.jsx)("div",{className:"App",children:Object(y.jsxs)(E.a,{theme:P,children:[Object(y.jsx)(L.a,{}),Object(y.jsx)(B,{})]})})},D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,150)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),o(e),r(e)}))};r.a.render(Object(y.jsx)(s.a.StrictMode,{children:Object(y.jsx)(A,{})}),document.getElementById("root")),D()},77:function(e,t,n){},78:function(e,t,n){}},[[108,1,2]]]);
//# sourceMappingURL=main.f09f875d.chunk.js.map